<!DOCTYPE html>
<html>
<body>
    <head>
            <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
            <link rel="shortcut icon" href="./favi4.ico"/>

        <style>
#header_nav, #mob_nav {
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome and Opera */
}
    .button{
        cursor:pointer;
    }
    @font-face{
        font-family: Times-Roman;
        src: url('./fonts/LiberationSerif-Regular.ttf');
    }
    @font-face {
        font-family: Canterbury-Regular;
        src: url('./fonts/Canterbury.ttf');
        }
    @font-face {
        font-family: Condor-Regular-Bold;
        src: url('./fonts/Condor-Bold.woff2');
        }
      @font-face{
        font-family: IKANSEEYOUALLTrial-AllOfYou;
        src: url('./fonts/IKANSEEYOUALL.woff2');
        }
      @font-face{
        font-family: KRSNATrial-Medium;
        src: url('./fonts/KRSNATrial-Medium.woff2');
      }
      @font-face{
      font-family:StolzlDisplay-Bold;
        src: url('./fonts/Stolzl/Stolzl Display Bold.otf');
      }
      @font-face{
      font-family:CourierNewPS-BoldMT;
      src: url('./fonts/CourierNewPS-BoldMT.ttf');
      }
      @font-face{
      font-family:CourierNewPSMT;
      src: url('./fonts/CourierNewPSMT.ttf');
      }
      @font-face{
      font-family:Arial-BoldMT;
      src: url('./fonts/Arial-BoldMT.ttf');
      }
      div{
          margin:0 auto;
      }
      </style>
<div>
<!-- <svg id="header_nav" viewBox="0 0 1400 178.876" xml:space="preserve">
            </svg> -->
<!-- <svg id="body" viewBox="0 150 1400 1208.876" xml:space="preserve">
    </svg> -->
<div id="header_nav"></div>
<div id="mob_nav"></div>
<div id="body">
<svg></svg>
</div>
</div>

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.6/chroma.min.js"></script><script type="text/JavaScript"></script>
  <script src="js/portfolio.js"></script>

<script>
    console.log(window.location.pathname);
    history.pushState({'state':'story'},'story','');
    
    var orientation;
    window.addEventListener("resize", mob_or_desk)
    mob_or_desk();
    function mob_or_desk(){
        var state = history.state.state;
        
        if (window.innerWidth > window.innerHeight){
            desk();
            if (state==="story"){
                desk_story();
            }
            if (state==="community"){
                desk_community();
            }
        } else {
            mob();
            if (state==="story"){
                mob_story();
            }
            if (state==="community"){
                mob_community();
            }
        }
    }
    function portfolio(){
        // portfolio
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('portfolio.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        .on('end', function(){
                            main();
                        })
                        
                    });
             history.pushState({'state':'portfolio'},'portfolio','');
            })


    }
    //desk
    function desk_story(){
        // story
        
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('story.html',function(){

                    // janky init
                    d3.select('#story_2_').select('.underline').selectAll('path')
                        .transition().duration(1000)
                        .style('fill','red');

                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        
                    });
                    history.pushState({'state':'story'},'story','');
            })
    }
    function desk_community(){
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('community.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        
                    });
                    history.pushState({'state':'community'},'community','');
            })
    }
    function desk_contact(){
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('contact.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        
                    });
                    history.pushState({'state':'contact'},'contact','');
            })
    }
    // header_nav
    function desk(){
        $('#mob_nav').html('');
        $('#header_nav').load('header_nav.html', function(){

            $('#story_2_').click(function(){
                unline();
                d3.select('#story_2_').select('.underline').selectAll('path')
                .transition().duration(1000)
                .style('fill','red');
                desk_story();
            });

            $('#short-portfolio_2_').click(function(){
                unline();
                d3.select('#short-portfolio_2_').select('.underline').selectAll('path')
                .transition().duration(1000)
                .style('fill','red');
                portfolio();
            });

            $('#community_2_').click(function(){
                unline();
                d3.select('#community_2_').select('.underline').selectAll('path')
                .transition().duration(1000)
                .style('fill','red');
                desk_community();
            });
            
            $('#contact').click(function(){
                unline();
                d3.select('#contact').select('.underline').selectAll('path')
                .transition().duration(1000)
                .style('fill','red');
                desk_contact();
            });

            d3.select('#story_2_').select('text').on('mouseover', function(){
                d3.select(this).transition().duration(2000).style('fill', '#EE2557');
            })
            .on('mouseout', function(){
                d3.select(this).transition().duration(2000).style('fill', 'black');
            })

            d3.select('#short-portfolio_2_').select('text').on('mouseover', function(){
                d3.select(this).transition().duration(2000).style('fill', '#EE2557');
            })
            .on('mouseout', function(){
                d3.select(this).transition().duration(2000).style('fill', 'black');
            })
            d3.select('#community_2_').select('text').on('mouseover', function(){
                d3.select(this).transition().duration(2000).style('fill', '#EE2557');
            })
            .on('mouseout', function(){
                d3.select(this).transition().duration(2000).style('fill', 'black');
            })

            d3.select('#contact').select('text').on('mouseover', function(){
                d3.select(this).transition().duration(2000).style('fill', '#EE2557');
            })
            .on('mouseout', function(){
                d3.select(this).transition().duration(2000).style('fill', 'black');
            })

        })
    }    
    
    
    //mob
    function mob_story(){
        // story
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('story_mob.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        .on('end', function(){
                            main();
                        })
                        
                    });
                    history.pushState({'state':'story'},'story','');
            })
        
    }

    function mob_community(){
        // story
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('community_mob.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        .on('end', function(){
                            main();
                        })
                        
                    });
                    history.pushState({'state':'community'},'community','');
            })
        
    }

        function mob_contact(){
        // story
        d3.select('#body').transition().duration(2000).select('svg').style('opacity','0')
            .on('end',function(){
                $('#body').load('contact_mob.html',function(){
                        d3.select('#body').select('svg').style('opacity','0')
                        .transition().duration(2000).style('opacity','1')
                        .on('end', function(){
                            main();
                        })
                        
                    });
                    history.pushState({'state':'contact'},'contact','');
            })
        
    }
    function mob(){
        $('#header_nav').load('header_mob.html', function(){
            $('#nav').click(mob_nav_click);
    })
    }

    function mob_nav_click(){
        if (document.getElementById('mob_nav_svg')){
            console.log('close')
            d3.select('#mob_nav').select('svg').transition().duration(2000).attr('viewBox','0 0 411 0')
            .on('end',function(){
            d3.select('#mob_nav').html('');
            d3.select("#nav").selectAll('path')
                            .transition().duration(2000).style('fill','black');
            });
            
        } else{
            pop_nav();
        }

        function pop_nav(){
            var mob_nav_svg = d3.select('#mob_nav').append('svg')
                .attr('height', '0px')
                .transition().duration(2000)
                .attr('height', '590px')
                .attr('viewBox', '0 0 411 250')
                .on('end', function(){

                    
                    function underliner(state){
                        if (state==='story'){
                            d3.select('#story_1_').select('.underline').selectAll('path')
                            .transition().duration(1000)
                            .style('fill','red');
                        }

                        if (state==='portfolio'){
                            d3.select('#short-portfolio_1_').select('.underline').selectAll('path')
                            .transition().duration(1000)
                            .style('fill','red');
                        }

                        if (state==='community'){
                            d3.select('#community_1_').select('.underline').selectAll('path')
                            .transition().duration(1000)
                            .style('fill','red');
                        }

                        if(state==='contact'){
                            d3.select('#contact').select('.underline').selectAll('path')
                            .transition().duration(1000)
                            .style('fill','red');
                        }
                    }
                    $('#mob_nav').load('nav_pop.html', function(){

                        d3.select('#nav').selectAll('path')
                            .transition().duration(2000)
                            .style('fill','red');
                        d3.select("#mob_nav").selectAll('text').style('fill','white')
                            .transition().duration(2000).style('fill','black');
                        d3.select("#mob_nav").selectAll('path').style('fill','white')
                            .transition().duration(2000).style('fill','black');

                        underliner(history.state.state);

                        $('#story_1_').click(function(){
                            unline();
                            mob_story();
                            history.pushState({'state':'story'},'story','');
                            underliner(history.state.state);
                        });
                        $("#short-portfolio_1_").click(function(){
                            unline();
                            portfolio()
                            history.pushState({'state':'portfolio'},'portfolio','');
                            underliner(history.state.state);
                        });
                        $('#community_1_').click(function(){
                            unline();
                            mob_community();
                            history.pushState({'state':'community'},'community','');
                            underliner(history.state.state);
                        });
                        $('#contact').click(function(){
                            unline();
                            desk_contact();
                            history.pushState({'state':'contact'},'contact','');
                            underliner(history.state.state);
                        });

                    })

                })
        }
        
    }

function unline(){
    d3.selectAll('.underline').selectAll('path')
    .transition().duration(1000)
    .style('fill','black');
}


</script>
</body>
</html>